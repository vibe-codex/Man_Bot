# ü§ñ Telegram Bot –¥–ª—è –û–±—É—á–µ–Ω–∏—è –°–æ–±–ª–∞–∑–Ω–µ–Ω–∏—é

–ë–æ—Ç-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ RAG (Retrieval-Augmented Generation) —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bot_telegram/
‚îú‚îÄ‚îÄ .env                    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ docker-compose.yml      # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ init_db/               # SQL —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ 01_init.sql        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
‚îú‚îÄ‚îÄ scripts/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ load_knowledge.py  # –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ö–Ω–∏–∫ –≤ –±–∞–∑—É
‚îú‚îÄ‚îÄ server/                # FastAPI RAG —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ app.py             # (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∏–∑ –∫–ª–æ–¥2.txt)
‚îî‚îÄ‚îÄ bot/                   # Telegram –±–æ—Ç
    ‚îú‚îÄ‚îÄ Dockerfile
    ‚îî‚îÄ‚îÄ bot.py             # (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∏–∑ –∫–ª–æ–¥2.txt)
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π

**Telegram Bot Token:**
1. –û—Ç–∫—Ä–æ–π Telegram –∏ –Ω–∞–π–¥–∏ `@BotFather`
2. –û—Ç–ø—Ä–∞–≤—å `/newbot`
3. –ü—Ä–∏–¥—É–º–∞–π –∏–º—è –∏ username
4. –°–∫–æ–ø–∏—Ä—É–π —Ç–æ–∫–µ–Ω (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `123456789:ABCdef...`)

**Google API Key (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
1. –ò–¥–∏ –Ω–∞ https://makersuite.google.com/app/apikey
2. –°–æ–∑–¥–∞–π API –∫–ª—é—á
3. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–∫–æ–ø–∏—Ä—É–π —à–∞–±–ª–æ–Ω
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env —Ñ–∞–π–ª
# –í—Å—Ç–∞–≤—å —Å–≤–æ–∏ —Ç–æ–∫–µ–Ω—ã –≤–º–µ—Å—Ç–æ placeholder'–æ–≤
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö)
pip install -r requirements.txt

# –ò–ª–∏ —á–µ—Ä–µ–∑ Docker (–¥–ª—è –∑–∞–ø—É—Å–∫–∞)
docker-compose up -d
```

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ö–Ω–∏–∫ –≤ –±–∞–∑—É

**‚ö†Ô∏è –í–ê–ñ–ù–û: –í–∞—à–∏ 60 —Ñ–∞–π–ª–æ–≤ –≤ `KIMI_OUTPUT/` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è!**
–°–∫—Ä–∏–ø—Ç —Ç–æ–ª—å–∫–æ –ß–ò–¢–ê–ï–¢ –∏—Ö –∏ —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏–∏ –≤ –±–∞–∑–µ.

```bash
cd scripts
python load_knowledge.py --provider google
```

–û–ø—Ü–∏–∏:
- `--provider google` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Generative AI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `--provider openai` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenAI
- `--provider deepseek` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DeepSeek
- `--source ../KIMI_OUTPUT` - –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å .md —Ñ–∞–π–ª–∞–º–∏

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker-compose logs -f telegram_bot
docker-compose logs -f rag_server
```

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π Telegram
2. –ù–∞–π–¥–∏ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞
3. –û—Ç–ø—Ä–∞–≤—å `/start`
4. –í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å –∏ —Ä–µ–∂–∏–º
5. –ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å!

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d --build

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker-compose down -v
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–∏–∫

1. –°–æ–∑–¥–∞–π .md —Ñ–∞–π–ª –≤ `KIMI_OUTPUT/` (–≤ —Ñ–æ—Ä–º–∞—Ç–µ Kimi)
2. –ó–∞–ø—É—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫—É:
   ```bash
   python scripts/load_knowledge.py --provider google
   ```
3. –ì–æ—Ç–æ–≤–æ! –ë–æ—Ç —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç –Ω–æ–≤—É—é —Ç–µ—Ö–Ω–∏–∫—É

### –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ
docker exec -it man_vector_db_bot psql -U man_admin -d man_vector_db

# –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã SQL:
\dt                    # —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
SELECT COUNT(*) FROM knowledge_units;  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Ö–Ω–∏–∫
SELECT ku_id, title FROM knowledge_units LIMIT 5;  # –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏
```

## üìù –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤ —Ç–µ—Ö–Ω–∏–∫

–ö–∞–∂–¥—ã–π .md —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å YAML frontmatter:

```yaml
---
id: unique_technique_id
title: "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏"
type: [—Ç–µ—Ö–Ω–∏–∫–∞, —Å–∫—Ä–∏–ø—Ç]
Level: –±–∞–∑–∞
UserLevelFit: [–Ω–æ–≤–∏—á–æ–∫, —Å—Ä–µ–¥–Ω–∏–π]
State: [–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ]
Stage: [–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ_—Ö–æ–ª–æ–¥–Ω–æ–µ, –°–≤–∏–¥–∞–Ω–∏–µ]
Channel: [–£–ª–∏—Ü–∞, –ö–ª—É–±/–±–∞—Ä]
Goal: [–≤–∑—è—Ç—å_–Ω–æ–º–µ—Ä, –Ω–∞–∑–Ω–∞—á–∏—Ç—å_—Å–≤–∏–¥–∞–Ω–∏–µ]
Style: [–†–æ–º–∞–Ω—Ç–∏–∫, –ü—Ä–æ–≤–æ–∫–∞—Ç–æ—Ä]
StrategyTags: [–¥–∏—Ä–µ–∫—Ç, –æ—Ç–∫—Ä—ã–≤–∞—à–∫–∞]
Riskiness: 2
Source: "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏"
Language: ru
---

## –°—É—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏
...
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|----------|--------|
| `TG_BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | `123456:ABC...` |
| `GOOGLE_API_KEY` | –ö–ª—é—á Google AI | `AIzaSyB...` |
| `DB_DSN` | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î | `postgresql://...` |
| `RAG_SERVER_URL` | URL RAG —Å–µ—Ä–≤–µ—Ä–∞ | `http://localhost:8000` |
| `LLM_MODEL` | –ú–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ | `gemini-pro` |
| `EMBED_DIMENSION` | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤ | `768` –∏–ª–∏ `1536` |

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
docker-compose logs telegram_bot

# –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:8000/docs
```

### –û—à–∏–±–∫–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä—å API –∫–ª—é—á
python -c "import os; print(os.getenv('GOOGLE_API_KEY'))"

# –ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Google
python scripts/load_knowledge.py --provider google --source ../KIMI_OUTPUT
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```bash
# –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker ps | grep postgres

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –±–∞–∑—É
docker-compose restart postgres
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [FastAPI](https://fastapi.tiangolo.com/)
- [aiogram 3](https://docs.aiogram.dev/)
- [pgvector](https://github.com/pgvector/pgvector)
- [Google Generative AI](https://ai.google.dev/)

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–í–∞—à–∏ 60 —Ñ–∞–π–ª–æ–≤** –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `KIMI_OUTPUT/` –∏ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è**
2. –°–∫—Ä–∏–ø—Ç `load_knowledge.py` —Ç–æ–ª—å–∫–æ **—á–∏—Ç–∞–µ—Ç** —Ñ–∞–π–ª—ã –∏ —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏–∏ –≤ –±–∞–∑–µ
3. –•—Ä–∞–Ω–∏ `.env` —Ñ–∞–π–ª –≤ —Å–µ–∫—Ä–µ—Ç–µ ‚Äî —Ç–∞–º API –∫–ª—é—á–∏!
4. –ù–µ –∫–æ–º–º–∏—Ç—å `.env` –≤ git

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `docker-compose logs`
2. –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –±–∞–∑–∞ –∑–∞–ø—É—â–µ–Ω–∞: `docker-compose ps`
4. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: `docker-compose restart`

---

**–°–æ–∑–¥–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Kimi AI Agent** ü§ñ
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026